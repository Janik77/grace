{% extends 'portal/base.html' %}
{% block title %}Склад{% endblock %}

{% block content %}
<h1 class="page-title">Склад и материалы</h1>
<p class="page-sub">Справочник материалов с учётом упаковок (рулоны, пачки) и ценой по умолчанию.</p>

<div class="card shadow-sm">
  <div class="card-header">Наличие на складе</div>
  <div class="table-responsive">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>SKU</th>
          <th>Материал</th>
          <th>Категория</th>
          <th>Ед. учёта</th>
          <th>Кол-во</th>
          <th>Упаковка</th>
          <th>Цена за базовую ед.</th>
          <th>Локация</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr>
            <td class="fw-semibold">{{ item.sku }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.category|default:'—' }}</td>
            <td>{{ item.get_base_unit_display }}</td>
            <td>
              {{ item.quantity_on_hand }}
              {% if item.package_count %}
                <div class="text-muted small">≈ {{ item.package_count|floatformat:2 }} {{ item.get_package_label }}</div>
              {% endif %}
            </td>
            <td>
              {% if item.package_size %}
                {{ item.package_size }} {{ item.get_base_unit_display }} ({{ item.get_package_label }})
              {% else %}
                —
              {% endif %}
            </td>
            <td>{{ item.default_unit_price|floatformat:2 }} ₸</td>
            <td>{{ item.location|default:'—' }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="8" class="text-center text-muted">Пока нет материалов. Добавьте их через админку.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
